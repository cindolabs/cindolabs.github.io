<!DOCTYPE html>
<html lang="id" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Hocindo Equity Growth Map - Interactive dashboard for equity growth analysis">
    <title>Hocindo Equity Growth Map</title>
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.8/css/dataTables.tailwindcss.min.css">
    <!-- AOS CSS -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            @apply bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100;
        }
        .dataTable-container {
            @apply max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-8;
        }
        .chart-container {
            @apply max-w-4xl mx-auto mt-8 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-lg;
        }
        .filter-container {
            @apply flex flex-col sm:flex-row gap-4 mb-6;
        }
        .export-btn {
            @apply inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition;
        }
        .mode-toggle {
            @apply fixed top-4 right-4 p-2 bg-gray-200 dark:bg-gray-700 rounded-full hover:bg-gray-300 dark:hover:bg-gray-600 transition;
        }
    </style>
</head>
<body>
    <!-- Mode Toggle -->
    <button id="modeToggle" class="mode-toggle" aria-label="Toggle dark mode">
        <i class="fas fa-moon"></i>
    </button>

    <!-- Header -->
    <header class="py-6 text-center" data-aos="fade-down">
        <h1 class="text-4xl font-bold text-gray-900 dark:text-white">Hocindo Equity Growth Map</h1>
        <p class="mt-2 text-lg text-gray-600 dark:text-gray-300">Interactive dashboard for equity growth analysis</p>
    </header>

    <!-- Filter and Export -->
    <div class="filter-container" data-aos="fade-up">
        <input type="text" id="searchInput" placeholder="Cari di tabel..." class="px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white">
        <select id="levelFilter" class="px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white">
            <option value="">Semua Level</option>
        </select>
        <button id="exportCsv" class="export-btn"><i class="fas fa-download mr-2"></i> Export CSV</button>
        <button id="exportJson" class="export-btn"><i class="fas fa-download mr-2"></i> Export JSON</button>
        <select id="languageSelect" class="px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white">
            <option value="id">Bahasa Indonesia</option>
            <option value="en">English</option>
        </select>
    </div>

    <!-- Table -->
    <div class="dataTable-container" data-aos="fade-up">
        <table id="equityTable" class="w-full">
            <thead>
                <tr>
                    <th>Level</th>
                    <th>Saldo</th>
                    <th>Volume</th>
                    <th>Laba / Rugi</th>
                    <th>Equitas Laba</th>
                    <th>Equitas Rugi</th>
                    <th>Piper</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data akan dimuat melalui JavaScript -->
            </tbody>
        </table>
    </div>

    <!-- Chart -->
    <div class="chart-container" data-aos="fade-up">
        <canvas id="equityChart"></canvas>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.tailwindcss.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://unpkg.com/i18next@23.10.1/dist/umd/i18next.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script>
        // Inisialisasi AOS
        AOS.init();

        // Data lengkap untuk 100 level
        const initialData = [
            { level: 1, saldo: 10.00, volume: 0.01, labaRugi: 1.00, equitasLaba: 11.00, equitasRugi: 9.00, piper: 100 },
            { level: 2, saldo: 11.00, volume: 0.01, labaRugi: 1.10, equitasLaba: 12.10, equitasRugi: 9.90, piper: 110 },
            { level: 3, saldo: 12.10, volume: 0.01, labaRugi: 1.21, equitasLaba: 13.31, equitasRugi: 10.89, piper: 121 },
            { level: 4, saldo: 13.31, volume: 0.01, labaRugi: 1.33, equitasLaba: 14.64, equitasRugi: 11.98, piper: 133 },
            { level: 5, saldo: 14.64, volume: 0.01, labaRugi: 1.46, equitasLaba: 16.10, equitasRugi: 13.18, piper: 146 },
            { level: 6, saldo: 16.10, volume: 0.01, labaRugi: 1.61, equitasLaba: 17.71, equitasRugi: 14.49, piper: 161 },
            { level: 7, saldo: 17.71, volume: 0.01, labaRugi: 1.77, equitasLaba: 19.48, equitasRugi: 15.94, piper: 177 },
            { level: 8, saldo: 19.48, volume: 0.01, labaRugi: 1.95, equitasLaba: 21.43, equitasRugi: 17.53, piper: 195 },
            { level: 9, saldo: 21.43, volume: 0.01, labaRugi: 2.14, equitasLaba: 23.57, equitasRugi: 19.29, piper: 214 },
            { level: 10, saldo: 23.57, volume: 0.02, labaRugi: 2.35, equitasLaba: 25.92, equitasRugi: 21.22, piper: 118 },
            { level: 11, saldo: 25.92, volume: 0.02, labaRugi: 2.59, equitasLaba: 28.51, equitasRugi: 23.33, piper: 130 },
            { level: 12, saldo: 28.51, volume: 0.02, labaRugi: 2.85, equitasLaba: 31.36, equitasRugi: 25.66, piper: 143 },
            { level: 13, saldo: 31.36, volume: 0.02, labaRugi: 3.13, equitasLaba: 34.49, equitasRugi: 28.23, piper: 157 },
            { level: 14, saldo: 34.49, volume: 0.02, labaRugi: 3.44, equitasLaba: 37.93, equitasRugi: 31.05, piper: 172 },
            { level: 15, saldo: 37.93, volume: 0.02, labaRugi: 3.79, equitasLaba: 41.72, equitasRugi: 34.14, piper: 190 },
            { level: 16, saldo: 41.72, volume: 0.03, labaRugi: 4.17, equitasLaba: 45.89, equitasRugi: 37.55, piper: 139 },
            { level: 17, saldo: 45.89, volume: 0.03, labaRugi: 4.58, equitasLaba: 50.47, equitasRugi: 41.31, piper: 153 },
            { level: 18, saldo: 50.47, volume: 0.04, labaRugi: 5.04, equitasLaba: 55.51, equitasRugi: 45.43, piper: 126 },
            { level: 19, saldo: 55.51, volume: 0.04, labaRugi: 5.55, equitasLaba: 61.06, equitasRugi: 49.96, piper: 139 },
            { level: 20, saldo: 61.06, volume: 0.05, labaRugi: 6.10, equitasLaba: 67.16, equitasRugi: 54.96, piper: 122 },
            { level: 21, saldo: 67.16, volume: 0.05, labaRugi: 6.71, equitasLaba: 73.87, equitasRugi: 60.45, piper: 135 },
            { level: 22, saldo: 73.87, volume: 0.06, labaRugi: 7.38, equitasLaba: 81.25, equitasRugi: 66.49, piper: 123 },
            { level: 23, saldo: 81.25, volume: 0.07, labaRugi: 8.12, equitasLaba: 89.37, equitasRugi: 73.13, piper: 116 },
            { level: 24, saldo: 89.37, volume: 0.07, labaRugi: 8.93, equitasLaba: 98.30, equitasRugi: 80.44, piper: 128 },
            { level: 25, saldo: 98.30, volume: 0.08, labaRugi: 9.83, equitasLaba: 108.13, equitasRugi: 88.47, piper: 123 },
            { level: 26, saldo: 108.13, volume: 0.09, labaRugi: 10.81, equitasLaba: 118.94, equitasRugi: 97.32, piper: 121 },
            { level: 27, saldo: 118.94, volume: 0.09, labaRugi: 11.89, equitasLaba: 130.83, equitasRugi: 107.05, piper: 133 },
            { level: 28, saldo: 130.83, volume: 0.10, labaRugi: 13.08, equitasLaba: 143.91, equitasRugi: 117.75, piper: 131 },
            { level: 29, saldo: 143.91, volume: 0.11, labaRugi: 14.39, equitasLaba: 158.30, equitasRugi: 129.52, piper: 131 },
            { level: 30, saldo: 158.30, volume: 0.12, labaRugi: 15.83, equitasLaba: 174.13, equitasRugi: 142.47, piper: 132 },
            { level: 31, saldo: 174.13, volume: 0.13, labaRugi: 17.41, equitasLaba: 191.54, equitasRugi: 156.72, piper: 134 },
            { level: 32, saldo: 191.54, volume: 0.14, labaRugi: 19.15, equitasLaba: 210.69, equitasRugi: 172.39, piper: 137 },
            { level: 33, saldo: 210.69, volume: 0.15, labaRugi: 21.06, equitasLaba: 231.75, equitasRugi: 189.63, piper: 141 },
            { level: 34, saldo: 231.75, volume: 0.16, labaRugi: 23.17, equitasLaba: 254.92, equitasRugi: 208.58, piper: 145 },
            { level: 35, saldo: 254.92, volume: 0.17, labaRugi: 25.49, equitasLaba: 280.41, equitasRugi: 229.43, piper: 150 },
            { level: 36, saldo: 280.41, volume: 0.18, labaRugi: 28.04, equitasLaba: 308.45, equitasRugi: 252.37, piper: 156 },
            { level: 37, saldo: 308.45, volume: 0.19, labaRugi: 30.84, equitasLaba: 339.29, equitasRugi: 277.61, piper: 163 },
            { level: 38, saldo: 339.29, volume: 0.20, labaRugi: 33.92, equitasLaba: 373.21, equitasRugi: 305.37, piper: 170 },
            { level: 39, saldo: 373.21, volume: 0.21, labaRugi: 37.32, equitasLaba: 410.53, equitasRugi: 335.89, piper: 178 },
            { level: 40, saldo: 410.53, volume: 0.22, labaRugi: 41.05, equitasLaba: 451.58, equitasRugi: 369.48, piper: 187 },
            { level: 41, saldo: 451.58, volume: 0.23, labaRugi: 45.15, equitasLaba: 496.73, equitasRugi: 406.43, piper: 197 },
            { level: 42, saldo: 496.73, volume: 0.24, labaRugi: 49.67, equitasLaba: 546.40, equitasRugi: 447.06, piper: 207 },
            { level: 43, saldo: 546.40, volume: 0.28, labaRugi: 54.64, equitasLaba: 601.04, equitasRugi: 491.76, piper: 196 },
            { level: 44, saldo: 601.04, volume: 0.30, labaRugi: 60.10, equitasLaba: 661.14, equitasRugi: 540.94, piper: 201 },
            { level: 45, saldo: 661.14, volume: 0.34, labaRugi: 66.11, equitasLaba: 727.25, equitasRugi: 595.03, piper: 195 },
            { level: 46, saldo: 727.25, volume: 0.35, labaRugi: 72.72, equitasLaba: 799.97, equitasRugi: 654.53, piper: 208 },
            { level: 47, saldo: 799.97, volume: 0.40, labaRugi: 79.99, equitasLaba: 879.96, equitasRugi: 719.98, piper: 200 },
            { level: 48, saldo: 879.96, volume: 0.45, labaRugi: 87.99, equitasLaba: 967.95, equitasRugi: 791.97, piper: 196 },
            { level: 49, saldo: 967.95, volume: 0.50, labaRugi: 96.79, equitasLaba: 1064.74, equitasRugi: 871.16, piper: 194 },
            { level: 50, saldo: 1064.74, volume: 0.55, labaRugi: 106.47, equitasLaba: 1171.21, equitasRugi: 958.27, piper: 194 },
            { level: 51, saldo: 1171.21, volume: 0.60, labaRugi: 117.12, equitasLaba: 1288.33, equitasRugi: 1054.09, piper: 195 },
            { level: 52, saldo: 1288.33, volume: 0.65, labaRugi: 128.83, equitasLaba: 1417.16, equitasRugi: 1159.50, piper: 198 },
            { level: 53, saldo: 1417.16, volume: 0.70, labaRugi: 141.72, equitasLaba: 1558.88, equitasRugi: 1275.44, piper: 202 },
            { level: 54, saldo: 1558.88, volume: 0.75, labaRugi: 155.89, equitasLaba: 1714.77, equitasRugi: 1402.99, piper: 208 },
            { level: 55, saldo: 1714.77, volume: 0.80, labaRugi: 171.48, equitasLaba: 1886.25, equitasRugi: 1543.29, piper: 214 },
            { level: 56, saldo: 1886.25, volume: 0.85, labaRugi: 188.63, equitasLaba: 2074.88, equitasRugi: 1697.62, piper: 222 },
            { level: 57, saldo: 2074.88, volume: 0.90, labaRugi: 207.49, equitasLaba: 2282.37, equitasRugi: 1867.39, piper: 231 },
            { level: 58, saldo: 2282.37, volume: 0.95, labaRugi: 228.24, equitasLaba: 2510.61, equitasRugi: 2054.13, piper: 240 },
            { level: 59, saldo: 2510.61, volume: 1.00, labaRugi: 251.06, equitasLaba: 2761.67, equitasRugi: 2259.55, piper: 251 },
            { level: 60, saldo: 2761.67, volume: 1.05, labaRugi: 276.17, equitasLaba: 3037.84, equitasRugi: 2485.50, piper: 263 },
            { level: 61, saldo: 3037.84, volume: 1.10, labaRugi: 303.78, equitasLaba: 3341.62, equitasRugi: 2734.06, piper: 276 },
            { level: 62, saldo: 3341.62, volume: 1.15, labaRugi: 334.16, equitasLaba: 3675.78, equitasRugi: 3007.46, piper: 291 },
            { level: 63, saldo: 3675.78, volume: 1.20, labaRugi: 367.58, equitasLaba: 4043.36, equitasRugi: 3308.20, piper: 306 },
            { level: 64, saldo: 4043.36, volume: 1.25, labaRugi: 404.34, equitasLaba: 4447.70, equitasRugi: 3639.02, piper: 323 },
            { level: 65, saldo: 4447.70, volume: 1.30, labaRugi: 444.77, equitasLaba: 4892.47, equitasRugi: 4002.93, piper: 342 },
            { level: 66, saldo: 4892.47, volume: 1.35, labaRugi: 489.25, equitasLaba: 5381.72, equitasRugi: 4403.22, piper: 362 },
            { level: 67, saldo: 5381.72, volume: 1.40, labaRugi: 538.17, equitasLaba: 5919.89, equitasRugi: 4843.55, piper: 384 },
            { level: 68, saldo: 5919.89, volume: 1.45, labaRugi: 591.99, equitasLaba: 6511.88, equitasRugi: 5327.90, piper: 408 },
            { level: 69, saldo: 6511.88, volume: 1.50, labaRugi: 651.19, equitasLaba: 7163.07, equitasRugi: 5860.69, piper: 434 },
            { level: 70, saldo: 7163.07, volume: 1.55, labaRugi: 716.31, equitasLaba: 7879.38, equitasRugi: 6446.76, piper: 462 },
            { level: 71, saldo: 7879.38, volume: 1.60, labaRugi: 787.94, equitasLaba: 8667.32, equitasRugi: 7091.44, piper: 492 },
            { level: 72, saldo: 8667.32, volume: 1.65, labaRugi: 866.73, equitasLaba: 9534.05, equitasRugi: 7800.59, piper: 525 },
            { level: 73, saldo: 9534.05, volume: 1.70, labaRugi: 953.41, equitasLaba: 10487.46, equitasRugi: 8580.64, piper: 561 },
            { level: 74, saldo: 10487.46, volume: 1.75, labaRugi: 1048.75, equitasLaba: 11536.21, equitasRugi: 9438.71, piper: 599 },
            { level: 75, saldo: 11536.21, volume: 1.80, labaRugi: 1153.62, equitasLaba: 12689.83, equitasRugi: 10382.59, piper: 641 },
            { level: 76, saldo: 12689.83, volume: 1.85, labaRugi: 1268.98, equitasLaba: 13958.81, equitasRugi: 11420.85, piper: 686 },
            { level: 77, saldo: 13958.81, volume: 1.90, labaRugi: 1395.88, equitasLaba: 15354.69, equitasRugi: 12562.93, piper: 735 },
            { level: 78, saldo: 15354.69, volume: 1.95, labaRugi: 1535.47, equitasLaba: 16890.16, equitasRugi: 13819.22, piper: 787 },
            { level: 79, saldo: 16890.16, volume: 2.00, labaRugi: 1689.02, equitasLaba: 18579.18, equitasRugi: 15201.14, piper: 845 },
            { level: 80, saldo: 18579.18, volume: 2.05, labaRugi: 1857.92, equitasLaba: 20437.10, equitasRugi: 16721.26, piper: 906 },
            { level: 81, saldo: 20437.10, volume: 2.10, labaRugi: 2043.71, equitasLaba: 22480.81, equitasRugi: 18393.39, piper: 974 },
            { level: 82, saldo: 22480.81, volume: 2.15, labaRugi: 2248.08, equitasLaba: 24728.89, equitasRugi: 20232.73, piper: 1046 },
            { level: 83, saldo: 24728.89, volume: 2.20, labaRugi: 2472.89, equitasLaba: 27201.78, equitasRugi: 22256.00, piper: 1124 },
            { level: 84, saldo: 27201.78, volume: 2.25, labaRugi: 2720.18, equitasLaba: 29921.96, equitasRugi: 24481.60, piper: 1209 },
            { level: 85, saldo: 29921.96, volume: 2.30, labaRugi: 2992.20, equitasLaba: 32914.16, equitasRugi: 26929.76, piper: 1301 },
            { level: 86, saldo: 32914.16, volume: 2.35, labaRugi: 3291.42, equitasLaba: 36205.58, equitasRugi: 29622.74, piper: 1401 },
            { level: 87, saldo: 36205.58, volume: 2.40, labaRugi: 3620.56, equitasLaba: 39826.14, equitasRugi: 32585.02, piper: 1509 },
            { level: 88, saldo: 39826.14, volume: 2.45, labaRugi: 3982.61, equitasLaba: 43808.75, equitasRugi: 35843.53, piper: 1626 },
            { level: 89, saldo: 43808.75, volume: 2.50, labaRugi: 4380.88, equitasLaba: 48189.63, equitasRugi: 39427.87, piper: 1752 },
            { level: 90, saldo: 48189.63, volume: 2.55, labaRugi: 4818.96, equitasLaba: 53008.59, equitasRugi: 43370.67, piper: 1890 },
            { level: 91, saldo: 53008.59, volume: 2.60, labaRugi: 5300.86, equitasLaba: 58309.45, equitasRugi: 47707.73, piper: 2039 },
            { level: 92, saldo: 58309.45, volume: 2.65, labaRugi: 5830.95, equitasLaba: 64140.40, equitasRugi: 52478.50, piper: 2200 },
            { level: 93, saldo: 64140.40, volume: 2.70, labaRugi: 6414.04, equitasLaba: 70554.44, equitasRugi: 57726.36, piper: 2376 },
            { level: 94, saldo: 70554.44, volume: 2.75, labaRugi: 7055.44, equitasLaba: 77609.88, equitasRugi: 63499.00, piper: 2566 },
            { level: 95, saldo: 77609.88, volume: 2.80, labaRugi: 7760.99, equitasLaba: 85370.87, equitasRugi: 69848.89, piper: 2772 },
            { level: 96, saldo: 85370.87, volume: 2.85, labaRugi: 8537.09, equitasLaba: 93907.96, equitasRugi: 76833.78, piper: 2995 },
            { level: 97, saldo: 93907.96, volume: 2.90, labaRugi: 9390.80, equitasLaba: 103298.76, equitasRugi: 84517.16, piper: 3238 },
            { level: 98, saldo: 103298.76, volume: 2.95, labaRugi: 10329.88, equitasLaba: 113628.64, equitasRugi: 92968.88, piper: 3502 },
            { level: 99, saldo: 113628.64, volume: 3.00, labaRugi: 11362.86, equitasLaba: 124991.50, equitasRugi: 102265.78, piper: 3788 },
            { level: 100, saldo: 124991.50, volume: 3.05, labaRugi: 12499.15, equitasLaba: 137490.65, equitasRugi: 112492.35, piper: 4098 }
        ];

        // Inisialisasi i18next untuk multibahasa
        i18next.init({
            lng: 'id',
            resources: {
                id: {
                    translation: {
                        "title": "Hocindo Equity Growth Map",
                        "description": "Dasbor interaktif untuk analisis pertumbuhan ekuitas",
                        "level": "Level",
                        "saldo": "Saldo",
                        "volume": "Volume",
                        "labaRugi": "Laba / Rugi",
                        "equitasLaba": "Equitas Laba",
                        "equitasRugi": "Equitas Rugi",
                        "piper": "Piper",
                        "searchPlaceholder": "Cari di tabel...",
                        "allLevels": "Semua Level",
                        "exportCsv": "Export CSV",
                        "exportJson": "Export JSON"
                    }
                },
                en: {
                    translation: {
                        "title": "Hocindo Equity Growth Map",
                        "description": "Interactive dashboard for equity growth analysis",
                        "level": "Level",
                        "saldo": "Balance",
                        "volume": "Volume",
                        "labaRugi": "Profit / Loss",
                        "equitasLaba": "Profit Equity",
                        "equitasRugi": "Loss Equity",
                        "piper": "Piper",
                        "searchPlaceholder": "Search in table...",
                        "allLevels": "All Levels",
                        "exportCsv": "Export CSV",
                        "exportJson": "Export JSON"
                    }
                }
            }
        }, function(err, t) {
            updateTranslations();
        });

        // Fungsi untuk update terjemahan
        function updateTranslations() {
            document.querySelector('h1').textContent = i18next.t('title');
            document.querySelector('header p').textContent = i18next.t('description');
            document.getElementById('searchInput').placeholder = i18next.t('searchPlaceholder');
            document.getElementById('levelFilter').options[0].text = i18next.t('allLevels');
            document.getElementById('exportCsv').innerHTML = `<i class="fas fa-download mr-2"></i> ${i18next.t('exportCsv')}`;
            document.getElementById('exportJson').innerHTML = `<i class="fas fa-download mr-2"></i> ${i18next.t('exportJson')}`;
            const headers = document.querySelectorAll('#equityTable thead th');
            headers[0].textContent = i18next.t('level');
            headers[1].textContent = i18next.t('saldo');
            headers[2].textContent = i18next.t('volume');
            headers[3].textContent = i18next.t('labaRugi');
            headers[4].textContent = i18next.t('equitasLaba');
            headers[5].textContent = i18next.t('equitasRugi');
            headers[6].textContent = i18next.t('piper');
        }

        // Inisialisasi DataTable
        const table = $('#equityTable').DataTable({
            data: initialData,
            columns: [
                { data: 'level' },
                { data: 'saldo', render: $.fn.dataTable.render.number(',', '.', 2, '$') },
                { data: 'volume', render: $.fn.dataTable.render.number(',', '.', 2) },
                { data: 'labaRugi', render: $.fn.dataTable.render.number(',', '.', 2, '$') },
                { data: 'equitasLaba', render: $.fn.dataTable.render.number(',', '.', 2, '$') },
                { data: 'equitasRugi', render: $.fn.dataTable.render.number(',', '.', 2, '$') },
                { data: 'piper' }
            ],
            pageLength: 10,
            responsive: true,
            language: {
                search: '',
                searchPlaceholder: i18next.t('searchPlaceholder')
            }
        });

        // Load data dari GitHub (opsional)
        async function loadDataFromGithub() {
            try {
                const response = await fetch('https://raw.githubusercontent.com/hocindo/hocindo.github.io/main/financial_dashboard/equity_data.json');
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const data = await response.json();
                table.clear().rows.add(data).draw();
            } catch (error) {
                console.error('Error loading data from GitHub:', error);
                alert('Gagal memuat data dari GitHub. Menggunakan data statis.');
            }
        }

        // Filter level
        const levelFilter = document.getElementById('levelFilter');
        initialData.forEach(row => {
            const option = document.createElement('option');
            option.value = row.level;
            option.text = `Level ${row.level}`;
            levelFilter.appendChild(option);
        });

        levelFilter.addEventListener('change', function() {
            const value = this.value;
            table.column(0).search(value ? `^${value}$` : '', true, false).draw();
        });

        // Search input
        document.getElementById('searchInput').addEventListener('input', function() {
            table.search(this.value).draw();
        });

        // Export CSV
        document.getElementById('exportCsv').addEventListener('click', function() {
            const data = table.data().toArray();
            const csv = Papa.unparse(data);
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'hocindo_equity_map.csv';
            link.click();
        });

        // Export JSON
        document.getElementById('exportJson').addEventListener('click', function() {
            const data = table.data().toArray();
            const json = JSON.stringify(data, null, 2);
            const blob = new Blob([json], { type: 'application/json;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'hocindo_equity_map.json';
            link.click();
        });

        // Dark mode toggle
        document.getElementById('modeToggle').addEventListener('click', function() {
            document.documentElement.classList.toggle('dark');
            this.innerHTML = document.documentElement.classList.contains('dark') 
                ? '<i class="fas fa-sun"></i>' 
                : '<i class="fas fa-moon"></i>';
        });

        // Inisialisasi Chart.js
        const ctx = document.getElementById('equityChart').getContext('2d');
        const equityChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: initialData.map(row => `Level ${row.level}`),
                datasets: [
                    {
                        label: 'Saldo',
                        data: initialData.map(row => row.saldo),
                        borderColor: '#4CAF50',
                        fill: false
                    },
                    {
                        label: 'Equitas Laba',
                        data: initialData.map(row => row.equitasLaba),
                        borderColor: '#2563eb',
                        fill: false
                    },
                    {
                        label: 'Equitas Rugi',
                        data: initialData.map(row => row.equitasRugi),
                        borderColor: '#dc2626',
                        fill: false
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: 'top' },
                    title: { display: true, text: 'Equity Growth Trend' }
                },
                scales: {
                    y: { beginAtZero: false, title: { display: true, text: 'Value ($)' } },
                    x: { 
                        title: { display: true, text: 'Level' },
                        ticks: {
                            maxTicksLimit: 20 // Limit x-axis labels to avoid clutter
                        }
                    }
                }
            }
        });

        // Update chart saat tabel di-filter
        table.on('draw', function() {
            const filteredData = table.rows({ filter: 'applied' }).data().toArray();
            equityChart.data.labels = filteredData.map(row => `Level ${row.level}`);
            equityChart.data.datasets[0].data = filteredData.map(row => row.saldo);
            equityChart.data.datasets[1].data = filteredData.map(row => row.equitasLaba);
            equityChart.data.datasets[2].data = filteredData.map(row => row.equitasRugi);
            equityChart.update();
        });

        // Ganti bahasa
        document.getElementById('languageSelect').addEventListener('change', function() {
            i18next.changeLanguage(this.value, function(err, t) {
                updateTranslations();
                table.draw();
            });
        });

        // Load data dari GitHub saat halaman dimuat
        loadDataFromGithub();
    </script>
</body>
</html>
