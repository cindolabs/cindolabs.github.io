<!DOCTYPE html>
<html lang="id" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Hocindo Equity Growth Map - Interactive dashboard for equity growth analysis">
    <title>Hocindo Equity Growth Map</title>
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.8/css/dataTables.tailwindcss.min.css">
    <!-- AOS CSS -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            @apply bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100;
        }
        .dataTable-container {
            @apply max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-8;
        }
        .chart-container {
            @apply max-w-4xl mx-auto mt-8 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-lg;
        }
        .filter-container {
            @apply flex flex-col sm:flex-row gap-4 mb-6;
        }
        .export-btn {
            @apply inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition;
        }
        .mode-toggle {
            @apply fixed top-4 right-4 p-2 bg-gray-200 dark:bg-gray-700 rounded-full hover:bg-gray-300 dark:hover:bg-gray-600 transition;
        }
    </style>
</head>
<body>
    <!-- Mode Toggle -->
    <button id="modeToggle" class="mode-toggle" aria-label="Toggle dark mode">
        <i class="fas fa-moon"></i>
    </button>

    <!-- Header -->
    <header class="py-6 text-center" data-aos="fade-down">
        <h1 class="text-4xl font-bold text-gray-900 dark:text-white">Hocindo Equity Growth Map</h1>
        <p class="mt-2 text-lg text-gray-600 dark:text-gray-300">Interactive dashboard for equity growth analysis</p>
    </header>

    <!-- Filter and Export -->
    <div class="filter-container" data-aos="fade-up">
        <input type="text" id="searchInput" placeholder="Cari di tabel..." class="px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white">
        <select id="levelFilter" class="px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white">
            <option value="">Semua Level</option>
        </select>
        <button id="exportCsv" class="export-btn"><i class="fas fa-download mr-2"></i> Export CSV</button>
        <button id="exportJson" class="export-btn"><i class="fas fa-download mr-2"></i> Export JSON</button>
        <select id="languageSelect" class="px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white">
            <option value="id">Bahasa Indonesia</option>
            <option value="en">English</option>
        </select>
    </div>

    <!-- Table -->
    <div class="dataTable-container" data-aos="fade-up">
        <table id="equityTable" class="w-full">
            <thead>
                <tr>
                    <th>Level</th>
                    <th>Saldo</th>
                    <th>Volume</th>
                    <th>Laba / Rugi</th>
                    <th>Equitas Laba</th>
                    <th>Equitas Rugi</th>
                    <th>Piper</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data akan dimuat melalui JavaScript -->
            </tbody>
        </table>
    </div>

    <!-- Chart -->
    <div class="chart-container" data-aos="fade-up">
        <canvas id="equityChart"></canvas>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.tailwindcss.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://unpkg.com/i18next@23.10.1/dist/umd/i18next.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script>
        // Inisialisasi AOS
        AOS.init();

        // Data lengkap untuk 100 level
        const initialData = [
            { level: 1, saldo: 10.00, volume: 0.01, labaRugi: 1.00, equitasLaba: 11.00, equitasRugi: 9.00, piper: 300 },
            { level: 2, saldo: 11.00, volume: 0.01, labaRugi: 1.10, equitasLaba: 12.10, equitasRugi: 9.90, piper: 300 },
            { level: 3, saldo: 12.10, volume: 0.01, labaRugi: 1.21, equitasLaba: 13.31, equitasRugi: 10.89, piper: 300 },
            { level: 4, saldo: 13.31, volume: 0.01, labaRugi: 1.33, equitasLaba: 14.64, equitasRugi: 11.98, piper: 300 },
            { level: 5, saldo: 14.64, volume: 0.01, labaRugi: 1.46, equitasLaba: 16.10, equitasRugi: 13.18, piper: 300 },
            { level: 6, saldo: 16.10, volume: 0.01, labaRugi: 1.61, equitasLaba: 17.71, equitasRugi: 14.49, piper: 300 },
            { level: 7, saldo: 17.71, volume: 0.01, labaRugi: 1.77, equitasLaba: 19.48, equitasRugi: 15.94, piper: 300 },
            { level: 8, saldo: 19.48, volume: 0.01, labaRugi: 1.95, equitasLaba: 21.43, equitasRugi: 17.53, piper: 300 },
            { level: 9, saldo: 21.43, volume: 0.02, labaRugi: 2.14, equitasLaba: 23.57, equitasRugi: 19.29, piper: 300 },
            { level: 10, saldo: 23.57, volume: 0.02, labaRugi: 2.36, equitasLaba: 25.93, equitasRugi: 21.21, piper: 300 },
            { level: 11, saldo: 25.93, volume: 0.02, labaRugi: 2.59, equitasLaba: 28.52, equitasRugi: 23.34, piper: 300 },
            { level: 12, saldo: 28.52, volume: 0.02, labaRugi: 2.85, equitasLaba: 31.37, equitasRugi: 25.67, piper: 300 },
            { level: 13, saldo: 31.37, volume: 0.02, labaRugi: 3.14, equitasLaba: 34.51, equitasRugi: 28.23, piper: 300 },
            { level: 14, saldo: 34.51, volume: 0.02, labaRugi: 3.45, equitasLaba: 37.96, equitasRugi: 31.06, piper: 300 },
            { level: 15, saldo: 37.96, volume: 0.02, labaRugi: 3.80, equitasLaba: 41.76, equitasRugi: 34.16, piper: 300 },
            { level: 16, saldo: 41.76, volume: 0.02, labaRugi: 4.18, equitasLaba: 45.94, equitasRugi: 37.58, piper: 300 },
            { level: 17, saldo: 45.94, volume: 0.02, labaRugi: 4.59, equitasLaba: 50.53, equitasRugi: 41.35, piper: 300 },
            { level: 18, saldo: 50.53, volume: 0.03, labaRugi: 5.05, equitasLaba: 55.58, equitasRugi: 45.48, piper: 300 },
            { level: 19, saldo: 55.58, volume: 0.03, labaRugi: 5.56, equitasLaba: 61.14, equitasRugi: 50.02, piper: 300 },
            { level: 20, saldo: 61.14, volume: 0.03, labaRugi: 6.11, equitasLaba: 67.25, equitasRugi: 55.03, piper: 300 },
            { level: 21, saldo: 67.25, volume: 0.03, labaRugi: 6.73, equitasLaba: 73.98, equitasRugi: 60.52, piper: 300 },
            { level: 22, saldo: 73.98, volume: 0.03, labaRugi: 7.40, equitasLaba: 81.38, equitasRugi: 66.58, piper: 300 },
            { level: 23, saldo: 81.38, volume: 0.03, labaRugi: 8.14, equitasLaba: 89.52, equitasRugi: 73.24, piper: 300 },
            { level: 24, saldo: 89.52, volume: 0.03, labaRugi: 8.95, equitasLaba: 98.47, equitasRugi: 80.57, piper: 300 },
            { level: 25, saldo: 98.47, volume: 0.03, labaRugi: 9.85, equitasLaba: 108.32, equitasRugi: 88.62, piper: 300 },
            { level: 26, saldo: 108.32, volume: 0.03, labaRugi: 10.83, equitasLaba: 119.15, equitasRugi: 97.49, piper: 300 },
            { level: 27, saldo: 119.15, volume: 0.03, labaRugi: 11.92, equitasLaba: 131.07, equitasRugi: 107.23, piper: 300 },
            { level: 28, saldo: 131.07, volume: 0.04, labaRugi: 13.11, equitasLaba: 144.18, equitasRugi: 117.96, piper: 300 },
            { level: 29, saldo: 144.18, volume: 0.04, labaRugi: 14.42, equitasLaba: 158.60, equitasRugi: 129.76, piper: 300 },
            { level: 30, saldo: 158.60, volume: 0.04, labaRugi: 15.86, equitasLaba: 174.46, equitasRugi: 142.74, piper: 300 },
            { level: 31, saldo: 174.46, volume: 0.04, labaRugi: 17.45, equitasLaba: 191.91, equitasRugi: 157.01, piper: 300 },
            { level: 32, saldo: 191.91, volume: 0.04, labaRugi: 19.19, equitasLaba: 211.10, equitasRugi: 172.72, piper: 300 },
            { level: 33, saldo: 211.10, volume: 0.04, labaRugi: 21.11, equitasLaba: 232.21, equitasRugi: 189.99, piper: 300 },
            { level: 34, saldo: 232.21, volume: 0.04, labaRugi: 23.22, equitasLaba: 255.43, equitasRugi: 208.99, piper: 300 },
            { level: 35, saldo: 255.43, volume: 0.05, labaRugi: 25.54, equitasLaba: 280.97, equitasRugi: 229.89, piper: 300 },
            { level: 36, saldo: 280.97, volume: 0.05, labaRugi: 28.10, equitasLaba: 309.07, equitasRugi: 252.87, piper: 300 },
            { level: 37, saldo: 309.07, volume: 0.05, labaRugi: 30.91, equitasLaba: 339.98, equitasRugi: 278.16, piper: 300 },
            { level: 38, saldo: 339.98, volume: 0.05, labaRugi: 34.00, equitasLaba: 373.98, equitasRugi: 305.98, piper: 300 },
            { level: 39, saldo: 373.98, volume: 0.05, labaRugi: 37.40, equitasLaba: 411.38, equitasRugi: 336.58, piper: 300 },
            { level: 40, saldo: 411.38, volume: 0.05, labaRugi: 41.14, equitasLaba: 452.52, equitasRugi: 370.24, piper: 300 },
            { level: 41, saldo: 452.52, volume: 0.06, labaRugi: 45.25, equitasLaba: 497.77, equitasRugi: 407.27, piper: 300 },
            { level: 42, saldo: 497.77, volume: 0.06, labaRugi: 49.78, equitasLaba: 547.55, equitasRugi: 447.99, piper: 300 },
            { level: 43, saldo: 547.55, volume: 0.06, labaRugi: 54.76, equitasLaba: 602.31, equitasRugi: 492.79, piper: 300 },
            { level: 44, saldo: 602.31, volume: 0.06, labaRugi: 60.23, equitasLaba: 662.54, equitasRugi: 542.08, piper: 300 },
            { level: 45, saldo: 662.54, volume: 0.06, labaRugi: 66.25, equitasLaba: 728.79, equitasRugi: 596.29, piper: 300 },
            { level: 46, saldo: 728.79, volume: 0.07, labaRugi: 72.88, equitasLaba: 801.67, equitasRugi: 655.91, piper: 300 },
            { level: 47, saldo: 801.67, volume: 0.07, labaRugi: 80.17, equitasLaba: 881.84, equitasRugi: 721.50, piper: 300 },
            { level: 48, saldo: 881.84, volume: 0.07, labaRugi: 88.18, equitasLaba: 970.02, equitasRugi: 793.66, piper: 300 },
            { level: 49, saldo: 970.02, volume: 0.07, labaRugi: 97.00, equitasLaba: 1067.02, equitasRugi: 873.02, piper: 300 },
            { level: 50, saldo: 1067.02, volume: 0.07, labaRugi: 106.70, equitasLaba: 1173.72, equitasRugi: 960.32, piper: 300 },
            { level: 51, saldo: 1173.72, volume: 0.08, labaRugi: 117.37, equitasLaba: 1291.09, equitasRugi: 1056.35, piper: 300 },
            { level: 52, saldo: 1291.09, volume: 0.08, labaRugi: 129.11, equitasLaba: 1420.20, equitasRugi: 1161.98, piper: 300 },
            { level: 53, saldo: 1420.20, volume: 0.08, labaRugi: 142.02, equitasLaba: 1562.22, equitasRugi: 1278.18, piper: 300 },
            { level: 54, saldo: 1562.22, volume: 0.08, labaRugi: 156.22, equitasLaba: 1718.44, equitasRugi: 1406.00, piper: 300 },
            { level: 55, saldo: 1718.44, volume: 0.08, labaRugi: 171.84, equitasLaba: 1890.28, equitasRugi: 1546.60, piper: 300 },
            { level: 56, saldo: 1890.28, volume: 0.09, labaRugi: 189.03, equitasLaba: 2079.31, equitasRugi: 1701.25, piper: 300 },
            { level: 57, saldo: 2079.31, volume: 0.09, labaRugi: 207.93, equitasLaba: 2287.24, equitasRugi: 1871.38, piper: 300 },
            { level: 58, saldo: 2287.24, volume: 0.09, labaRugi: 228.72, equitasLaba: 2515.96, equitasRugi: 2058.52, piper: 300 },
            { level: 59, saldo: 2515.96, volume: 0.09, labaRugi: 251.60, equitasLaba: 2767.56, equitasRugi: 2264.36, piper: 300 },
            { level: 60, saldo: 2767.56, volume: 0.09, labaRugi: 276.76, equitasLaba: 3044.32, equitasRugi: 2490.80, piper: 300 },
            { level: 61, saldo: 3044.32, volume: 0.10, labaRugi: 304.43, equitasLaba: 3348.75, equitasRugi: 2739.89, piper: 300 },
            { level: 62, saldo: 3348.75, volume: 0.10, labaRugi: 334.88, equitasLaba: 3683.63, equitasRugi: 3013.87, piper: 300 },
            { level: 63, saldo: 3683.63, volume: 0.10, labaRugi: 368.36, equitasLaba: 4051.99, equitasRugi: 3315.27, piper: 300 },
            { level: 64, saldo: 4051.99, volume: 0.10, labaRugi: 405.20, equitasLaba: 4457.19, equitasRugi: 3646.79, piper: 300 },
            { level: 65, saldo: 4457.19, volume: 0.10, labaRugi: 445.72, equitasLaba: 4902.91, equitasRugi: 4011.47, piper: 300 },
            { level: 66, saldo: 4902.91, volume: 0.11, labaRugi: 490.29, equitasLaba: 5393.20, equitasRugi: 4412.62, piper: 300 },
            { level: 67, saldo: 5393.20, volume: 0.11, labaRugi: 539.32, equitasLaba: 5932.52, equitasRugi: 4853.88, piper: 300 },
            { level: 68, saldo: 5932.52, volume: 0.11, labaRugi: 593.25, equitasLaba: 6525.77, equitasRugi: 5339.27, piper: 300 },
            { level: 69, saldo: 6525.77, volume: 0.11, labaRugi: 652.58, equitasLaba: 7178.35, equitasRugi: 5873.19, piper: 300 },
            { level: 70, saldo: 7178.35, volume: 0.11, labaRugi: 717.84, equitasLaba: 7896.19, equitasRugi: 6460.51, piper: 300 },
            { level: 71, saldo: 7896.19, volume: 0.12, labaRugi: 789.62, equitasLaba: 8685.81, equitasRugi: 7106.57, piper: 300 },
            { level: 72, saldo: 8685.81, volume: 0.12, labaRugi: 868.58, equitasLaba: 9554.39, equitasRugi: 7817.23, piper: 300 },
            { level: 73, saldo: 9554.39, volume: 0.12, labaRugi: 955.44, equitasLaba: 10509.83, equitasRugi: 8598.95, piper: 300 },
            { level: 74, saldo: 10509.83, volume: 0.12, labaRugi: 1050.98, equitasLaba: 11560.81, equitasRugi: 9458.85, piper: 300 },
            { level: 75, saldo: 11560.81, volume: 0.12, labaRugi: 1156.08, equitasLaba: 12716.89, equitasRugi: 10404.73, piper: 300 },
            { level: 76, saldo: 12716.89, volume: 0.13, labaRugi: 1271.69, equitasLaba: 13988.58, equitasRugi: 11445.20, piper: 300 },
            { level: 77, saldo: 13988.58, volume: 0.13, labaRugi: 1398.86, equitasLaba: 15387.44, equitasRugi: 12589.72, piper: 300 },
            { level: 78, saldo: 15387.44, volume: 0.13, labaRugi: 1538.74, equitasLaba: 16926.18, equitasRugi: 13848.70, piper: 300 },
            { level: 79, saldo: 16926.18, volume: 0.13, labaRugi: 1692.62, equitasLaba: 18618.80, equitasRugi: 15233.56, piper: 300 },
            { level: 80, saldo: 18618.80, volume: 0.13, labaRugi: 1861.88, equitasLaba: 20480.68, equitasRugi: 16756.92, piper: 300 },
            { level: 81, saldo: 20480.68, volume: 0.14, labaRugi: 2048.07, equitasLaba: 22528.75, equitasRugi: 18432.61, piper: 300 },
            { level: 82, saldo: 22528.75, volume: 0.14, labaRugi: 2252.88, equitasLaba: 24781.63, equitasRugi: 20275.87, piper: 300 },
            { level: 83, saldo: 24781.63, volume: 0.14, labaRugi: 2478.16, equitasLaba: 27259.79, equitasRugi: 22303.47, piper: 300 },
            { level: 84, saldo: 27259.79, volume: 0.14, labaRugi: 2725.98, equitasLaba: 29985.77, equitasRugi: 24533.81, piper: 300 },
            { level: 85, saldo: 29985.77, volume: 0.14, labaRugi: 2998.58, equitasLaba: 32984.35, equitasRugi: 26987.19, piper: 300 },
            { level: 86, saldo: 32984.35, volume: 0.15, labaRugi: 3298.44, equitasLaba: 36282.79, equitasRugi: 29685.91, piper: 300 },
            { level: 87, saldo: 36282.79, volume: 0.15, labaRugi: 3628.28, equitasLaba: 39911.07, equitasRugi: 32654.51, piper: 300 },
            { level: 88, saldo: 39911.07, volume: 0.15, labaRugi: 3991.11, equitasLaba: 43902.18, equitasRugi: 35919.96, piper: 300 },
            { level: 89, saldo: 43902.18, volume: 0.15, labaRugi: 4390.22, equitasLaba: 48292.40, equitasRugi: 39511.96, piper: 300 },
            { level: 90, saldo: 48292.40, volume: 0.15, labaRugi: 4829.24, equitasLaba: 53121.64, equitasRugi: 43463.16, piper: 300 },
            { level: 91, saldo: 53121.64, volume: 0.16, labaRugi: 5312.16, equitasLaba: 58433.80, equitasRugi: 47809.48, piper: 300 },
            { level: 92, saldo: 58433.80, volume: 0.16, labaRugi: 5843.38, equitasLaba: 64277.18, equitasRugi: 52590.42, piper: 300 },
            { level: 93, saldo: 64277.18, volume: 0.16, labaRugi: 6427.72, equitasLaba: 70704.90, equitasRugi: 57849.46, piper: 300 },
            { level: 94, saldo: 70704.90, volume: 0.16, labaRugi: 7070.49, equitasLaba: 77775.39, equitasRugi: 63634.41, piper: 300 },
            { level: 95, saldo: 77775.39, volume: 0.16, labaRugi: 7777.54, equitasLaba: 85552.93, equitasRugi: 69997.85, piper: 300 },
            { level: 96, saldo: 85552.93, volume: 0.17, labaRugi: 8555.29, equitasLaba: 94108.22, equitasRugi: 76997.64, piper: 300 },
            { level: 97, saldo: 94108.22, volume: 0.17, labaRugi: 9410.82, equitasLaba: 103519.04, equitasRugi: 84697.40, piper: 300 },
            { level: 98, saldo: 103519.04, volume: 0.17, labaRugi: 10351.90, equitasLaba: 113870.94, equitasRugi: 93167.14, piper: 300 },
            { level: 99, saldo: 113870.94, volume: 0.17, labaRugi: 11387.09, equitasLaba: 125258.03, equitasRugi: 102483.85, piper: 300 },
            { level: 100, saldo: 125258.03, volume: 0.17, labaRugi: 12525.80, equitasLaba: 137783.83, equitasRugi: 112732.23, piper: 300 }
        ];

        // Inisialisasi i18next untuk multibahasa
        i18next.init({
            lng: 'id',
            resources: {
                id: {
                    translation: {
                        "title": "Hocindo Equity Growth Map",
                        "description": "Dasbor interaktif untuk analisis pertumbuhan ekuitas",
                        "level": "Level",
                        "saldo": "Saldo",
                        "volume": "Volume",
                        "labaRugi": "Laba / Rugi",
                        "equitasLaba": "Equitas Laba",
                        "equitasRugi": "Equitas Rugi",
                        "piper": "Piper",
                        "searchPlaceholder": "Cari di tabel...",
                        "allLevels": "Semua Level",
                        "exportCsv": "Export CSV",
                        "exportJson": "Export JSON"
                    }
                },
                en: {
                    translation: {
                        "title": "Hocindo Equity Growth Map",
                        "description": "Interactive dashboard for equity growth analysis",
                        "level": "Level",
                        "saldo": "Balance",
                        "volume": "Volume",
                        "labaRugi": "Profit / Loss",
                        "equitasLaba": "Profit Equity",
                        "equitasRugi": "Loss Equity",
                        "piper": "Piper",
                        "searchPlaceholder": "Search in table...",
                        "allLevels": "All Levels",
                        "exportCsv": "Export CSV",
                        "exportJson": "Export JSON"
                    }
                }
            }
        }, function(err, t) {
            updateTranslations();
        });

        // Fungsi untuk update terjemahan
        function updateTranslations() {
            document.querySelector('h1').textContent = i18next.t('title');
            document.querySelector('header p').textContent = i18next.t('description');
            document.getElementById('searchInput').placeholder = i18next.t('searchPlaceholder');
            document.getElementById('levelFilter').options[0].text = i18next.t('allLevels');
            document.getElementById('exportCsv').innerHTML = `<i class="fas fa-download mr-2"></i> ${i18next.t('exportCsv')}`;
            document.getElementById('exportJson').innerHTML = `<i class="fas fa-download mr-2"></i> ${i18next.t('exportJson')}`;
            const headers = document.querySelectorAll('#equityTable thead th');
            headers[0].textContent = i18next.t('level');
            headers[1].textContent = i18next.t('saldo');
            headers[2].textContent = i18next.t('volume');
            headers[3].textContent = i18next.t('labaRugi');
            headers[4].textContent = i18next.t('equitasLaba');
            headers[5].textContent = i18next.t('equitasRugi');
            headers[6].textContent = i18next.t('piper');
        }

        // Inisialisasi DataTable
        const table = $('#equityTable').DataTable({
            data: initialData,
            columns: [
                { data: 'level' },
                { data: 'saldo', render: $.fn.dataTable.render.number(',', '.', 2, '$') },
                { data: 'volume', render: $.fn.dataTable.render.number(',', '.', 2) },
                { data: 'labaRugi', render: $.fn.dataTable.render.number(',', '.', 2, '$') },
                { data: 'equitasLaba', render: $.fn.dataTable.render.number(',', '.', 2, '$') },
                { data: 'equitasRugi', render: $.fn.dataTable.render.number(',', '.', 2, '$') },
                { data: 'piper' }
            ],
            pageLength: 10,
            responsive: true,
            language: {
                search: '',
                searchPlaceholder: i18next.t('searchPlaceholder')
            }
        });

        // Load data dari GitHub (opsional)
        async function loadDataFromGithub() {
            try {
                const response = await fetch('https://raw.githubusercontent.com/hocindo/hocindo.github.io/main/financial_dashboard/equity_data.json');
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const data = await response.json();
                table.clear().rows.add(data).draw();
            } catch (error) {
                console.error('Error loading data from GitHub:', error);
                alert('Gagal memuat data dari GitHub. Menggunakan data statis.');
            }
        }

        // Filter level
        const levelFilter = document.getElementById('levelFilter');
        initialData.forEach(row => {
            const option = document.createElement('option');
            option.value = row.level;
            option.text = `Level ${row.level}`;
            levelFilter.appendChild(option);
        });

        levelFilter.addEventListener('change', function() {
            const value = this.value;
            table.column(0).search(value ? `^${value}$` : '', true, false).draw();
        });

        // Search input
        document.getElementById('searchInput').addEventListener('input', function() {
            table.search(this.value).draw();
        });

        // Export CSV
        document.getElementById('exportCsv').addEventListener('click', function() {
            const data = table.data().toArray();
            const csv = Papa.unparse(data);
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'hocindo_equity_map.csv';
            link.click();
        });

        // Export JSON
        document.getElementById('exportJson').addEventListener('click', function() {
            const data = table.data().toArray();
            const json = JSON.stringify(data, null, 2);
            const blob = new Blob([json], { type: 'application/json;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'hocindo_equity_map.json';
            link.click();
        });

        // Dark mode toggle
        document.getElementById('modeToggle').addEventListener('click', function() {
            document.documentElement.classList.toggle('dark');
            this.innerHTML = document.documentElement.classList.contains('dark') 
                ? '<i class="fas fa-sun"></i>' 
                : '<i class="fas fa-moon"></i>';
        });

        // Inisialisasi Chart.js
        const ctx = document.getElementById('equityChart').getContext('2d');
        const equityChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: initialData.map(row => `Level ${row.level}`),
                datasets: [
                    {
                        label: 'Saldo',
                        data: initialData.map(row => row.saldo),
                        borderColor: '#4CAF50',
                        fill: false
                    },
                    {
                        label: 'Equitas Laba',
                        data: initialData.map(row => row.equitasLaba),
                        borderColor: '#2563eb',
                        fill: false
                    },
                    {
                        label: 'Equitas Rugi',
                        data: initialData.map(row => row.equitasRugi),
                        borderColor: '#dc2626',
                        fill: false
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: 'top' },
                    title: { display: true, text: 'Equity Growth Trend' }
                },
                scales: {
                    y: { beginAtZero: false, title: { display: true, text: 'Value ($)' } },
                    x: { 
                        title: { display: true, text: 'Level' },
                        ticks: {
                            maxTicksLimit: 20 // Limit x-axis labels to avoid clutter
                        }
                    }
                }
            }
        });

        // Update chart saat tabel di-filter
        table.on('draw', function() {
            const filteredData = table.rows({ filter: 'applied' }).data().toArray();
            equityChart.data.labels = filteredData.map(row => `Level ${row.level}`);
            equityChart.data.datasets[0].data = filteredData.map(row => row.saldo);
            equityChart.data.datasets[1].data = filteredData.map(row => row.equitasLaba);
            equityChart.data.datasets[2].data = filteredData.map(row => row.equitasRugi);
            equityChart.update();
        });

        // Ganti bahasa
        document.getElementById('languageSelect').addEventListener('change', function() {
            i18next.changeLanguage(this.value, function(err, t) {
                updateTranslations();
                table.draw();
            });
        });

        // Load data dari GitHub saat halaman dimuat
        loadDataFromGithub();
    </script>
</body>
</html>
